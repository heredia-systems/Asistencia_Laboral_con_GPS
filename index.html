<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Formulario GPS ‚Äì Ministerio de Educaci√≥n</title>

    <!-- Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

    <!-- Google Identity -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <style>
        body {
            margin: 0;
            min-height: 100vh;
            font-family: Arial, sans-serif;
            background-image: url("https://i.imgur.com/uzTMB1l.jpeg");
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }

        .overlay {
            min-height: 100vh;
            background-color: rgba(0, 51, 102, 0.55);
            padding-bottom: 40px;
            padding-top: 1px;
        }

        h1 {
            text-align: center;
            color: #ffffff;
            margin: 25px 15px;
        }

        form {
            background: rgba(255, 255, 255, 0.96);
            padding: 25px;
            max-width: 620px;
            margin: auto;
            border-radius: 10px;
        }

        .fila {
            margin-bottom: 15px;
        }

        label {
            font-weight: bold;
            color: #003366;
        }

        input, select, button, video {
            width: 100%;
            padding: 9px;
        }

        input[readonly] {
            background-color: #f2f2f2;
        }

        button {
            background-color: #f4b400;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
        }

        button:hover {
            background-color: #e0a800;
        }

        #map {
            height: 300px;
            margin-top: 15px;
            border-radius: 8px;
            border: 2px solid #003366;
        }

        #registroInicial {
            display: none;
            background: rgba(255, 255, 255, 0.96);
            padding: 25px;
            max-width: 620px;
            margin: auto;
            border-radius: 10px;
            margin-bottom: 20px;
        }
/* ===== MODAL PROFESIONAL ===== */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.6);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 9999;
}

.modal-box {
    background: #ffffff;
    padding: 25px;
    border-radius: 10px;
    width: 90%;
    max-width: 380px;
    text-align: center;
    box-shadow: 0 5px 25px rgba(0,0,0,0.3);
    animation: aparecer 0.3s ease;
}

.modal-box.success {
    border-top: 6px solid #2e7d32;
}

.modal-box.error {
    border-top: 6px solid #c62828;
}

.modal-icon {
    font-size: 48px;
    margin-bottom: 10px;
}

.modal-box.success .modal-icon {
    color: #2e7d32;
}

.modal-box.error .modal-icon {
    color: #c62828;
}

.modal-text {
    font-size: 16px;
    margin-bottom: 20px;
}

.modal-box button {
    background-color: #f4b400;
    border: none;
    padding: 10px 20px;
    font-weight: bold;
    border-radius: 5px;
    cursor: pointer;
}

@keyframes aparecer {
    from { transform: scale(0.8); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
}
        /* ================= MODAL ALERTA ================= */

        .modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.6);
            z-index: 9999;
            align-items: center;
            justify-content: center;
        }

        .modal-box {
            background: #ffffff;
            max-width: 420px;
            width: 90%;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .modal-icon {
            font-size: 42px;
            margin-bottom: 10px;
        }

        .modal-text {
            font-size: 18px;
            color: #003366;
            margin-bottom: 20px;
        }

        .modal-box.success .modal-icon {
            color: #2e7d32;
        }

        .modal-box.error .modal-icon {
            color: #c62828;
        }

        .modal-box button {
            background-color: #003366;
            color: white;
            padding: 10px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-weight: bold;
        }

        .modal-box button:hover {
            background-color: #002244;
        }
form#gpsForm > button {
    margin-bottom: 15px;
}
    </style>
</head>

<body>

<div class="overlay">

    <h1>Registro de Marcaci√≥n Institucional con GPS</h1>

    <!-- üîê LOGIN GOOGLE -->
    <div style="text-align:center; margin-bottom:15px;">
        <div id="g_id_onload"
             data-client_id="942537115951-3iom1kgrq385tvcofnovdv769sgafsb5.apps.googleusercontent.com"
             data-callback="handleCredentialResponse"
             data-auto_prompt="false">
        </div>
        <div class="g_id_signin"></div>
    </div>

    <!-- REGISTRO INICIAL -->
    <form id="registroInicial">
        <h2>Registro inicial de usuario</h2>

        <div class="fila"><label>Correo institucional</label><input type="email" id="correo_registro" readonly></div>
        <div class="fila"><label>Nombres y apellidos</label><input type="text" id="nombres_registro"></div>
        <div class="fila"><label>Zona</label><input type="text" id="zona_registro"></div>
        <div class="fila"><label>Distrito</label><input type="text" id="distrito_registro"></div>
        <div class="fila"><label>Instituci√≥n</label><input type="text" id="institucion_registro"></div>
        <div class="fila"><label>Fecha</label><input type="text" id="fecha_registro" readonly></div>
        <button type="button" onclick="guardarRegistroInicial()">Guardar registro inicial</button>
    </form>

    <!-- FORMULARIO GPS -->
    <form id="gpsForm">
        <div class="fila"><label>Correo</label><input type="email" id="correo" readonly></div>
        <div class="fila"><label>Nombres</label><input type="text" id="responsable"></div>
        <div class="fila"><label>Instituci√≥n</label><input type="text" id="institucion"></div>

        <div class="fila">
            <label>Tipo de marcaci√≥n</label>
            <select id="tipo_marcacion">
                <option value="">Seleccione</option>
                <option value="entrada">Entrada</option>
                <option value="salida_almuerzo">Salida almuerzo</option>
                <option value="retorno_almuerzo">Retorno almuerzo</option>
                <option value="salida">Salida laboral</option>
            </select>
        </div>

        <input type="hidden" id="latitud">
        <input type="hidden" id="longitud">

        <div id="map"></div>

        <div class="fila">
            <label>Captura de imagen</label>
            <video id="video" autoplay></video>
            <button type="button" onclick="tomarFoto()">Capturar imagen</button>
            <canvas id="canvas" style="display:none"></canvas>
        </div>

        <button type="button" onclick="obtenerUbicacion()">Obtener ubicaci√≥n</button>
        <button type="button" onclick="enviarMarcacion()">Registrar marcaci√≥n</button>
    </form>
</div>

<!-- MODAL -->
<div class="modal-overlay" id="modalAlerta">
    <div class="modal-box" id="modalBox">
        <div class="modal-icon" id="modalIcon">‚úî</div>
        <div class="modal-text" id="modalText"></div>
        <button onclick="cerrarModal()">Aceptar</button>
    </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="script.js"></script>
<!-- MODAL DE ALERTAS -->
<div id="modalAlerta" class="modal-overlay" onclick="cerrarModal()">
    <div id="modalBox" class="modal-box" onclick="event.stopPropagation()">
        <div id="modalIcon" class="modal-icon">‚úî</div>
        <div id="modalText" class="modal-text"></div>
        <button onclick="cerrarModal()">Aceptar</button>
    </div>
</div>
</body>
</html>